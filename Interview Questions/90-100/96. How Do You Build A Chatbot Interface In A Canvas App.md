### **96. How do you build a chatbot interface in a canvas app?**

*   **Concept:** While you can embed a PVA bot, you can also build a **custom chat interface** from scratch within a canvas app for a fully branded experience.
*   **Implementation Steps:**
    1.  **Design the UI:**
        *   Create a **Gallery** control to display the chat history. The `Items` property will be a collection (e.g., `colChatHistory`).
        *   The gallery template should have labels for the message and the sender.
        *   Add a **Text Input** control for the user's message and a **Send Button**.
    2.  **Manage the Conversation Logic:**
        *   The Send Button's `OnSelect` should:
            *   `Collect( colChatHistory, {Sender: "User", Message: TextInput_Message.Text} )` - Add the user's message to the history.
            *   Call an **AI service** to get a response. This could be:
                *   **An Azure OpenAI** model via a custom connector.
                *   **Power Virtual Agents** via a Power Automate flow.
            *   `Collect( colChatHistory, {Sender: "Bot", Message: aiServiceResponse} )` - Add the bot's response to the history.
        *   Use a `Timer` control to automatically scroll the gallery to the latest message.
