# Listed Gallery in Power Apps - Comprehensive Guide

## Definition and Overview

*   A **Listed Gallery** in Power Apps is a specific configuration of the Gallery control that displays items in a structured list format.
*   Unlike horizontal or vertical galleries, listed galleries present data in a tabular or list view with clearly defined rows and columns.
*   This gallery type is ideal for displaying structured data where users need to quickly scan and compare information across multiple fields.

## Key Characteristics

### Visual Structure
*   Displays items in a vertical list format
*   Each item appears as a row with multiple columns
*   Maintains consistent spacing and alignment
*   Provides a table-like viewing experience

### Layout Properties
*   **Direction:** Vertical (default list orientation)
*   **Wrap count:** Typically set to 1 for single-column list appearance
*   **Layout:** Fixed to list format with predefined template
*   **Item spacing:** Consistent padding between list items

## Creating a Listed Gallery

### Step-by-Step Creation Process

1.  **Insert Gallery Control:**
    ```powerfx
    // From Insert menu → Gallery → Vertical
    Insert → Gallery → Vertical
    ```

2.  **Configure Data Source:**
    ```powerfx
    // Set Items property to your data source
    Gallery1.Items = SharePointListName
    // or
    Gallery1.Items = CollectionName
    ```

3.  **Select Listed Layout:**
    *   Choose "List" layout from layout options
    *   Configure column structure and data fields

### Layout Configuration
```powerfx
// Typical listed gallery properties
Gallery1.Layout = Layout.Vertical
Gallery1.TemplateSize = 60 // Row height
Gallery1.WrapCount = 1 // Single column list
```

## Common Use Cases

### Data Display Scenarios
*   **Employee directories** with name, department, contact info
*   **Product catalogs** with item name, price, category
*   **Task lists** with task name, due date, status
*   **Contact lists** with name, phone, email
*   **Inventory management** with item code, quantity, location

### Business Applications
*   **CRM systems** for customer records
*   **Project management** for task tracking
*   **HR systems** for employee information
*   **Inventory tracking** for stock management
*   **Service catalogs** for service listings

## Configuration and Customization

### Basic Properties Setup

```powerfx
// Gallery Properties
Gallery1.Items = Filter(SharePointList, Status = "Active")
Gallery1.TemplateSize = 70
Gallery1.WrapCount = 1

// Template Properties
TemplateFill = RGBA(255, 255, 255, 1)  // White background
TemplatePadding = 10
TemplateBorder = 1  // Subtle border
```

### Data Binding Example

```powerfx
// Sample data structure for listed gallery
Gallery1.Items = [
    {Name: "John Doe", Department: "Sales", Email: "john@company.com"},
    {Name: "Jane Smith", Department: "Marketing", Email: "jane@company.com"},
    {Name: "Mike Johnson", Department: "IT", Email: "mike@company.com"}
]

// Template controls binding
Label1.Text = ThisItem.Name
Label2.Text = ThisItem.Department  
Label3.Text = ThisItem.Email
```

## Advanced Features

### Sorting and Filtering
```powerfx
// Sort by name ascending
Gallery1.Items = Sort(Employees, Name, Ascending)

// Filter active employees
Gallery1.Items = Filter(Employees, Status = "Active")

// Search functionality
Gallery1.Items = If(
    !IsBlank(SearchBox.Text),
    Filter(Employees, StartsWith(Name, SearchBox.Text)),
    Employees
)
```

### Interactive Elements
```powerfx
// Selection handling
If(Gallery1.Selected <> Blank(),
    Navigate(DetailScreen, ScreenTransition.Cover),
    Notify("Please select an item", NotificationType.Information)
)

// Button in each row
Button1.OnSelect = Patch(Employees, ThisItem, {Status: "Completed"})
```

## Design Best Practices

### Visual Design
*   **Consistent spacing** between list items
*   **Clear column headers** for better readability
*   **Alternating row colors** for easier scanning
*   **Appropriate font sizes** and contrast ratios
*   **Responsive design** for different screen sizes

### Performance Optimization
```powerfx
// Limit data loading for large datasets
Gallery1.Items = FirstN(Filter(DataSource, Condition), 100)

// Implement pagination
Gallery1.Items = FirstN(Sort(DataSource, CreatedDate, Descending), PageSize)

// Use delegation-friendly functions
Gallery1.Items = Filter(DataSource, 
    StartsWith(FirstName, SearchTerm) && Status = "Active"
)
```

## Comparison with Other Gallery Types

### Listed vs. Vertical Gallery
*   **Listed Gallery:** Structured table-like format, multiple data points per row
*   **Vertical Gallery:** Flexible layout, can include images and complex controls

### Listed vs. Horizontal Gallery  
*   **Listed Gallery:** Vertical scrolling, ideal for long lists
*   **Horizontal Gallery:** Side-scrolling, good for cards or visual items

### Listed vs. Blank Gallery
*   **Listed Gallery:** Predefined list structure
*   **Blank Gallery:** Complete layout flexibility, requires manual setup

## Common Patterns and Templates

### Simple Contact List Template
```powerfx
// Data structure
Contacts = [
    {Name: "Alice Brown", Phone: "555-0101", Email: "alice@email.com"},
    {Name: "Bob Green", Phone: "555-0102", Email: "bob@email.com"}
]

// Gallery template
NameLabel.Text = ThisItem.Name
PhoneLabel.Text = ThisItem.Phone
EmailLabel.Text = ThisItem.Email
```

### Task Management Template
```powerfx
// Data structure
Tasks = [
    {TaskName: "Design Mockups", DueDate: "2024-01-15", Status: "In Progress"},
    {TaskName: "Client Meeting", DueDate: "2024-01-20", Status: "Pending"}
]

// Gallery template  
TaskLabel.Text = ThisItem.TaskName
DueDateLabel.Text = ThisItem.DueDate
StatusLabel.Text = ThisItem.Status
StatusLabel.Color = Switch(
    ThisItem.Status,
    "Completed", Green,
    "In Progress", Orange,
    "Pending", Red,
    Black
)
```

## Troubleshooting Common Issues

### Data Display Problems
```powerfx
// Check for empty data source
If(IsEmpty(Gallery1.Items),
    LabelError.Text = "No records found",
    LabelError.Visible = false
)

// Handle loading errors
IfError(
    Gallery1.Items = DataSource,
    Notify("Failed to load data", NotificationType.Error)
)
```

### Performance Issues
```powerfx
// Implement lazy loading for large datasets
Gallery1.Items = FirstN(DataSource, LoadCount)

// Use collections for offline capability
If(Connection.Connected,
    Collect(LocalCache, DataSource),
    Gallery1.Items = LocalCache
)
```

## Integration with Other Controls

### Search and Filter Integration
```powerfx
// Search box integration
SearchBox.OnChange = Reset(Gallery1.Selected)

// Filter integration
FilterDropdown.OnChange = UpdateContext({CurrentFilter: FilterDropdown.Selected.Value})
Gallery1.Items = Filter(DataSource, Category = CurrentFilter)
```

### Form Integration
```powerfx
// Edit selected item
If(Gallery1.Selected <> Blank(),
    EditForm(Form1, Gallery1.Selected),
    NewForm(Form1)
)

// Save changes
SubmitForm(Form1)
ResetForm(Form1)
```

## Mobile Optimization

### Responsive Design
```powerfx
// Adjust layout for mobile
If(App.Size = ScreenSize.Small,
    Set(GalleryTemplateHeight, 80),
    Set(GalleryTemplateHeight, 60)
)

// Optimize touch targets
Button1.Height = 44  // Minimum touch target size
Button1.Width = 44
```

## Security Considerations

### Data Protection
```powerfx
// Row-level security
Gallery1.Items = Filter(DataSource, 
    Department = User().Department || User().Email = "admin@company.com"
)

// Field-level security
If(User().Role = "Manager",
    SalaryLabel.Visible = true,
    SalaryLabel.Visible = false
)
```

> [!IMPORTANT]
> Listed galleries are most effective when you need to display multiple data points per item in a structured, scannable format. They provide the familiarity of a spreadsheet or database view while maintaining the interactive capabilities of Power Apps.

## Real-World Example

### Employee Directory Implementation
```powerfx
// Gallery setup
galEmployees.Items = Sort(Filter(Employees, IsActive = true), LastName, Ascending)

// Template controls
lblName.Text = ThisItem.FirstName & " " & ThisItem.LastName
lblDepartment.Text = ThisItem.Department
lblEmail.Text = ThisItem.Email
lblPhone.Text = ThisItem.Phone

// Interactive elements
btnViewProfile.OnSelect = Navigate(ProfileScreen, ScreenTransition.Cover, 
    {SelectedEmployee: ThisItem}
)

// Visual indicators
If(ThisItem.IsOnLeave,
    rectIndicator.Fill = Color.Yellow,
    rectIndicator.Fill = Color.Transparent
)
```

This comprehensive guide covers everything from basic setup to advanced implementation of listed galleries in Power Apps, providing a solid foundation for building effective data display interfaces.
